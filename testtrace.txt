============================= test session starts ==============================
platform linux -- Python 3.9.23, pytest-8.4.1, pluggy-1.5.0 -- /opt/miniconda3/envs/testbed/bin/python
cachedir: .pytest_cache
hypothesis profile 'default'

Running tests with stingray version 0.4.dev325+g9670ecdb0.d20250903.
Running tests in stingray docs.

Date: 2025-09-04T00:39:12

Platform: Linux-5.15.133.1-microsoft-standard-WSL2-x86_64-with-glibc2.35

Executable: /opt/miniconda3/envs/testbed/bin/python

Full Python Version: 
3.9.23 (main, Jun  5 2025, 13:40:20) 
[GCC 11.2.0]

encodings: sys: utf-8, locale: UTF-8, filesystem: utf-8
byteorder: little
float info: dig: 15, mant_dig: 15

Package versions:
Numpy: 1.26.4
Scipy: 1.13.1
Matplotlib: 3.9.2
h5py: 3.14.0
scikit-image: not available

Using Astropy options: remote_data: none.

rootdir: /app
configfile: setup.cfg
testpaths: stingray, docs
plugins: filter-subpackage-0.2.0, arraydiff-0.6.1, remotedata-0.4.1, hypothesis-6.138.2, astropy-header-0.2.2, cov-6.0.0, mock-3.14.0, doctestplus-1.3.0, astropy-0.11.0
collecting ... collected 1287 items / 1284 deselected / 3 selected

stingray/tests/test_crossspectrum.py::TestAveragedCrossspectrumEvents::test_from_lc_iterable_single_lc_with_segments FAILED [ 33%]
stingray/tests/test_crossspectrum.py::TestAveragedCrossspectrumEvents::test_from_lc_iterable_single_lc_no_segments FAILED [ 66%]
stingray/tests/test_powerspectrum.py::TestAveragedPowerspectrumEvents::test_from_lc_iterable_single_lc_with_segments PASSED [100%]

=================================== FAILURES ===================================
_ TestAveragedCrossspectrumEvents.test_from_lc_iterable_single_lc_with_segments _

self = <stingray.tests.test_crossspectrum.TestAveragedCrossspectrumEvents object at 0x7f1b8726df70>

    def test_from_lc_iterable_single_lc_with_segments(self):
        """Test from_lc_iterable with single light curves and segments"""
        lc1 = self.events1.to_lc(self.dt)
        lc2 = self.events2.to_lc(self.dt)

        #Test with segments
        cs_iter = AveragedCrossspectrum.from_lc_iterable(
            [lc1], [lc2], dt=self.dt, segment_size=self.segment_size, norm='none', silent=True)
>       cs_direct = AveragedCrossspectrum.from_lc_lightcurve(
            lc1, lc2, dt=self.dt, segment_size=self.segment_size, norm='none', silent=True)
E       AttributeError: type object 'AveragedCrossspectrum' has no attribute 'from_lc_lightcurve'

stingray/tests/test_crossspectrum.py:253: AttributeError
_ TestAveragedCrossspectrumEvents.test_from_lc_iterable_single_lc_no_segments __

self = <stingray.tests.test_crossspectrum.TestAveragedCrossspectrumEvents object at 0x7f1b8751b9d0>

    def test_from_lc_iterable_single_lc_no_segments(self):
        """Test from_lc_iterable with single light curves without segmentation"""
        lc1 = self.events1.to_lc(self.dt)
        lc2 = self.events2.to_lc(self.dt)

        #Test without segments
>       cs_iter = Crossspectrum.from_lc_iterable([lc1], [lc2], dt=self.dt, silent=True)
E       TypeError: from_lc_iterable() missing 1 required positional argument: 'segment_size'

stingray/tests/test_crossspectrum.py:267: TypeError
=============================== warnings summary ===============================
stingray/utils.py:751
  /app/stingray/utils.py:751: DeprecationWarning: invalid escape sequence \s
    """Calculate the excess variance.

stingray/utils.py:29
  /app/stingray/utils.py:29: UserWarning: Numba not installed. Faking it
    warnings.warn("Numba not installed. Faking it")

stingray/lightcurve.py:1643
  /app/stingray/lightcurve.py:1643: DeprecationWarning: invalid escape sequence \_
    """

stingray/lightcurve.py:1676
  /app/stingray/lightcurve.py:1676: DeprecationWarning: invalid escape sequence \_
    """

stingray/powerspectrum.py:213
  /app/stingray/powerspectrum.py:213: DeprecationWarning: invalid escape sequence \s
    """

stingray/powerspectrum.py:327
  /app/stingray/powerspectrum.py:327: DeprecationWarning: invalid escape sequence \o
    """Upper limit on a sinusoidal modulation.

stingray/fourier.py:93
  /app/stingray/fourier.py:93: DeprecationWarning: invalid escape sequence \m
    """Poisson (white)-noise level in a periodogram of pure counting noise.

stingray/fourier.py:181
  /app/stingray/fourier.py:181: DeprecationWarning: invalid escape sequence \m
    """Fractional rms normalization.

stingray/fourier.py:268
  /app/stingray/fourier.py:268: DeprecationWarning: invalid escape sequence \m
    """Absolute rms normalization.

stingray/fourier.py:319
  /app/stingray/fourier.py:319: DeprecationWarning: invalid escape sequence \d
    """Leahy+83 normalization, from the variance of the lc.

stingray/fourier.py:18
  /app/stingray/fourier.py:18: UserWarning: pyfftw not installed. Using standard scipy fft
    warnings.warn("pyfftw not installed. Using standard scipy fft")

stingray/stats.py:909
  /app/stingray/stats.py:909: DeprecationWarning: invalid escape sequence \o
    """Upper limit on a sinusoidal modulation, given a measured power in the PDS/Z search.

stingray/crosscorrelation.py:9
  /app/stingray/crosscorrelation.py:9: UserWarning: pyfftw not installed. Using standard scipy fft
    warnings.warn("pyfftw not installed. Using standard scipy fft")

stingray/bispectrum.py:11
  /app/stingray/bispectrum.py:11: UserWarning: pyfftw not installed. Using standard scipy fft
    warnings.warn("pyfftw not installed. Using standard scipy fft")

stingray/conftest.py:38
  /app/stingray/conftest.py:38: AstropyDeprecationWarning: The enable_deprecations_as_exceptions function is deprecated and may be removed in a future version.
          Use https://docs.pytest.org/en/stable/warnings.html instead.
    enable_deprecations_as_exceptions()

stingray/deadtime/fad.py:38
  /app/stingray/deadtime/fad.py:38: DeprecationWarning: invalid escape sequence \&
    """Calculate Frequency Amplitude Difference-corrected (cross)power spectra.

stingray/deadtime/fad.py:292
  /app/stingray/deadtime/fad.py:292: DeprecationWarning: invalid escape sequence \&
    """Calculate Frequency Amplitude Difference-corrected (cross)power spectra.

stingray/deadtime/fad.py:6
  /app/stingray/deadtime/fad.py:6: DeprecationWarning: Please import `gaussian_filter1d` from the `scipy.ndimage` namespace; the `scipy.ndimage.filters` namespace is deprecated and will be removed in SciPy 2.0.0.
    from scipy.ndimage.filters import gaussian_filter1d

stingray/pulse/accelsearch.py:25
  /app/stingray/pulse/accelsearch.py:25: UserWarning: Using standard numpy fft
    warnings.warn("Using standard numpy fft")

stingray/simulator/transfer.py:185
  /app/stingray/simulator/transfer.py:185: DeprecationWarning: invalid escape sequence \_
    """

stingray/simulator/transfer.py:208
  /app/stingray/simulator/transfer.py:208: DeprecationWarning: invalid escape sequence \_
    """

stingray/tests/test_multitaper.py:7
  /app/stingray/tests/test_multitaper.py:7: DeprecationWarning: Please import `TransferFunction` from the `scipy.signal` namespace; the `scipy.signal.ltisys` namespace is deprecated and will be removed in SciPy 2.0.0.
    from scipy.signal.ltisys import TransferFunction

stingray/tests/test_crossspectrum.py::TestAveragedCrossspectrumEvents::test_from_lc_iterable_single_lc_with_segments
  /app/stingray/fourier.py:688: UserWarning: n_ave is below 30. Please note that the error bars on the quantities derived from the cross spectrum are only reliable for a large number of averaged powers.
    warnings.warn("n_ave is below 30. Please note that the error bars "

stingray/tests/test_crossspectrum.py::TestAveragedCrossspectrumEvents::test_from_lc_iterable_single_lc_with_segments
  /app/stingray/crossspectrum.py:2654: UserWarning: Some error bars in the Averaged Crossspectrum are invalid.Defaulting to sqrt(2 / M) in Leahy norm, rescaled to the appropriate norm.
    warnings.warn(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED stingray/tests/test_crossspectrum.py::TestAveragedCrossspectrumEvents::test_from_lc_iterable_single_lc_with_segments
FAILED stingray/tests/test_crossspectrum.py::TestAveragedCrossspectrumEvents::test_from_lc_iterable_single_lc_no_segments
========== 2 failed, 1 passed, 1284 deselected, 24 warnings in 5.84s ===========